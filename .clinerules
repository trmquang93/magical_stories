version: 1.1
rules:
  - name: "Swift Testing TDD Rule"
    description: "Enforce Test-Driven Development using Swift Testing framework"
    checkpoints:
      - type: "test_syntax"
        verification:
          - "Uses @Test macro appropriately"
          - "Uses #expect for assertions"
          - "Uses #require for optional unwrapping"
          - "Implements parameterized tests where applicable"
          - "Uses appropriate test traits"

      - type: "test_organization"
        verification:
          - "Tests are properly grouped"
          - "Uses descriptive test names"
          - "Applies appropriate tags"
          - "Handles async tests correctly"

      - type: "tdd_workflow"
        files_to_update:
          - "magical-storiesTests/*.swift"
        verification:
          - "Red: Initial test fails"
          - "Green: Minimal implementation passes"
          - "Refactor: Maintains passing tests"

    memory_categories:
      - type: "test_patterns"
        description: "Swift Testing patterns and best practices"
        retention: "permanent"

  - name: "Documentation Update Rule"
    description: "Ensure documentation is updated when project changes occur"
    checkpoints:
      - type: "architecture_changes"
        files_to_update:
          - "documents/technical/architecture-overview.md"
          - "documents/project/technical-roadmap.md"
          - "documents/development/project-plan.md"
      
      - type: "api_changes"
        files_to_update:
          - "documents/api/google-ai-integration.md"
          - "documents/api/storekit-integration.md"
      
      - type: "data_model_changes"
        files_to_update:
          - "documents/data/swift-data-schema.md"
          - "documents/data/persistence-guide.md"
      
      - type: "security_changes"
        files_to_update:
          - "documents/security/security-guidelines.md"
          - "documents/security/privacy-compliance.md"
      
      - type: "ui_changes"
        files_to_update:
          - "documents/ui/design-system.md"
          - "documents/ui/accessibility.md"
      
      - type: "feature_changes"
        files_to_update:
          - "documents/MVP-requirements.md"
          - "documents/Growth-Path-Stories.md"
          - "documents/App-structure.md"

  - name: "Review Checklist"
    description: "Ensure all necessary documentation is reviewed and updated"
    checklist:
      - "Have you updated all affected documentation?"
      - "Have you reviewed the changes with the team?"
      - "Have you updated the version numbers if applicable?"
      - "Have you validated all code examples in documentation?"

  - name: "Memory Tracking Rule"
    description: "Track and manage system memories and important information"
    memory_categories:
      - type: "technical_decisions"
        description: "Architecture and technical choice rationales"
        retention: "permanent"
        
      - type: "requirements"
        description: "Project requirements and constraints"
        retention: "project_duration"
        
      - type: "user_preferences"
        description: "User-specified preferences and configurations"
        retention: "permanent"
        
      - type: "context"
        description: "Project context and background information"
        retention: "project_duration"
        
    memories:
      []  # Empty array ready to store future memories
